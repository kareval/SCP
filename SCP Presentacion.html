<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dominio del Control Financiero con SCP System</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            /* Constrain width for readability */
            height: 350px;
            /* Default height */
            margin-left: auto;
            margin-right: auto;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .chart-container {
                height: 280px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Connector Lines for Hierarchy Diagram (CSS-only, NO SVG) */
        .hierarchy-line {
            width: 2px;
            background-color: #cbd5e1;
            margin: 0 auto;
        }

        .hierarchy-branch {
            height: 20px;
            border-left: 2px solid #cbd5e1;
            border-right: 2px solid #cbd5e1;
            border-top: 2px solid #cbd5e1;
            width: 50%;
            margin: 0 auto;
        }
    </style>
    <!-- 
    Palette Reference:
    Deep Navy (Primary): #0F172A
    Teal (Success/Revenue): #14B8A6
    Red (Danger/Cost): #EF4444
    Amber (Warning/WIP): #F59E0B
    Indigo (Forecast): #6366F1
    -->
</head>

<body class="bg-slate-50 text-slate-800 antialiased">

    <!-- Navbar -->
    <nav class="bg-slate-900 text-white sticky top-0 z-50 shadow-lg border-b border-teal-500">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="font-bold text-xl tracking-tight">SCP <span class="text-teal-400">System</span></div>
            <div class="hidden md:flex space-x-6 text-sm font-medium">
                <a href="#intro" class="hover:text-teal-400 transition">Inicio</a>
                <a href="#structure" class="hover:text-teal-400 transition">Estructura</a>
                <a href="#revenue" class="hover:text-teal-400 transition">Cash vs Revenue</a>
                <a href="#evm" class="hover:text-teal-400 transition">KPIs EVM</a>
                <a href="#scenarios" class="hover:text-teal-400 transition">Escenarios</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="intro" class="py-20 bg-gradient-to-br from-slate-900 to-slate-800 text-white relative overflow-hidden">
        <div class="container mx-auto px-4 relative z-10 text-center">
            <span
                class="inline-block py-1 px-3 rounded-full bg-teal-500/20 text-teal-300 text-xs font-bold tracking-wider mb-6 border border-teal-500/30">MANUAL
                DEL CURSO v1.2</span>
            <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight">
                Salud Financiera del Proyecto
            </h1>
            <p class="text-lg md:text-xl text-slate-300 max-w-3xl mx-auto mb-10 leading-relaxed">
                Emitir una factura no es ganar dinero. Este curso transforma Jefes de Proyecto en Controllers, dominando
                la diferencia entre
                <span class="text-amber-400 font-semibold">Caja</span> y <span
                    class="text-teal-400 font-semibold">Devengo</span>.
            </p>

            <!-- Key Objectives Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto">
                <div class="bg-white/5 backdrop-blur-sm p-4 rounded-xl border border-white/10">
                    <div class="text-2xl mb-2">üí∞</div>
                    <div class="font-bold text-sm">Facturaci√≥n vs Ingreso</div>
                </div>
                <div class="bg-white/5 backdrop-blur-sm p-4 rounded-xl border border-white/10">
                    <div class="text-2xl mb-2">üìä</div>
                    <div class="font-bold text-sm">Indicadores EVM</div>
                </div>
                <div class="bg-white/5 backdrop-blur-sm p-4 rounded-xl border border-white/10">
                    <div class="text-2xl mb-2">üö®</div>
                    <div class="font-bold text-sm">Gesti√≥n de Riesgos</div>
                </div>
                <div class="bg-white/5 backdrop-blur-sm p-4 rounded-xl border border-white/10">
                    <div class="text-2xl mb-2">üîÆ</div>
                    <div class="font-bold text-sm">Proyecci√≥n (EAC)</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 1: Structure & Hierarchy -->
    <section id="structure" class="py-16 container mx-auto px-4">
        <div class="max-w-4xl mx-auto mb-12 text-center">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">1. La Estructura del Poder</h2>
            <p class="text-slate-600">
                Antes de controlar, debemos estructurar. Muchos PMs confunden el contrato legal con el proyecto de
                ejecuci√≥n.
                SCP utiliza una jerarqu√≠a estricta para proteger la rentabilidad.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <!-- CSS Diagram (Replacing Mermaid/SVG) -->
            <div class="bg-white p-8 rounded-2xl shadow-lg border border-slate-100">
                <div class="text-center font-bold text-slate-400 text-xs uppercase mb-6 tracking-widest">Jerarqu√≠a
                    Financiera</div>

                <!-- Master Agreement -->
                <div class="mx-auto w-64 bg-slate-800 text-white p-4 rounded-lg shadow-md relative z-10">
                    <div class="text-xs text-slate-400 font-bold uppercase mb-1">Entidad Legal</div>
                    <div class="font-bold text-lg">Contrato Marco</div>
                    <div class="text-xs text-teal-400 mt-1">Total Contract Value (TCV)</div>
                </div>

                <!-- Connector -->
                <div class="h-8 w-0.5 bg-slate-300 mx-auto"></div>
                <div class="hierarchy-branch"></div>

                <!-- Projects -->
                <div class="flex justify-center gap-4 mt-0">
                    <!-- Project A -->
                    <div class="w-40 pt-4">
                        <div class="h-4 w-0.5 bg-slate-300 mx-auto"></div>
                        <div class="bg-white border-2 border-teal-500 p-3 rounded-lg text-center shadow-sm">
                            <div class="font-bold text-slate-800 text-sm">Proyecto A</div>
                            <div class="text-xs text-slate-500 mt-1">Presupuesto A</div>
                        </div>
                    </div>
                    <!-- Project B -->
                    <div class="w-40 pt-4">
                        <div class="h-4 w-0.5 bg-slate-300 mx-auto"></div>
                        <div class="bg-white border-2 border-teal-500 p-3 rounded-lg text-center shadow-sm">
                            <div class="font-bold text-slate-800 text-sm">Proyecto B</div>
                            <div class="text-xs text-slate-500 mt-1">Presupuesto B</div>
                        </div>
                    </div>
                </div>

                <div class="mt-8 bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-900 rounded-r">
                    <strong>Best Practice:</strong> Nunca inicies un proyecto sin vincularlo a un contrato activo. El
                    presupuesto operativo debe "beber" del techo financiero del contrato.
                </div>
            </div>

            <!-- Project Types Table -->
            <div class="space-y-6">
                <h3 class="font-bold text-xl text-slate-800">Tipolog√≠as de Proyecto</h3>

                <div
                    class="bg-white rounded-xl shadow p-6 border border-slate-100 hover:border-teal-500 transition-colors cursor-default">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-2xl">‚è±Ô∏è</span>
                        <h4 class="font-bold text-lg">Time & Materials (T&M)</h4>
                    </div>
                    <p class="text-sm text-slate-600 mb-2">Revenue = Coste Incurrido. Se factura lo que se trabaja.</p>
                    <div
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                        Riesgo Bajo (Proveedor)
                    </div>
                </div>

                <div
                    class="bg-white rounded-xl shadow p-6 border border-slate-100 hover:border-red-500 transition-colors cursor-default">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-2xl">üîí</span>
                        <h4 class="font-bold text-lg">Fixed Price (Precio Fijo)</h4>
                    </div>
                    <p class="text-sm text-slate-600 mb-2">Presupuesto cerrado. Si gastas m√°s, pierdes margen.</p>
                    <div
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                        Riesgo M√°ximo
                    </div>
                </div>

                <div
                    class="bg-white rounded-xl shadow p-6 border border-slate-100 hover:border-indigo-500 transition-colors cursor-default">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-2xl">üß™</span>
                        <h4 class="font-bold text-lg">Interno (I+D)</h4>
                    </div>
                    <p class="text-sm text-slate-600 mb-2">No factura. Consume recursos (Coste de Oportunidad).</p>
                    <div
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800">
                        Inversi√≥n
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Financial Heart (Revenue vs Cash) -->
    <section id="revenue" class="py-16 bg-white border-y border-slate-200">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto mb-12 text-center">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">2. El Coraz√≥n Financiero</h2>
                <p class="text-slate-600">
                    El concepto m√°s cr√≠tico: <strong>Emitir una factura NO es ganar dinero.</strong>
                    El sistema calcula la diferencia entre lo trabajado (Revenue) y lo facturado (Billed) para
                    determinar la posici√≥n contable.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-12">
                <!-- Concept Explainer -->
                <div class="space-y-6">
                    <div class="p-6 bg-amber-50 rounded-xl border border-amber-200">
                        <h3 class="text-amber-800 font-bold text-lg mb-2">WIP (Work In Progress) - Activo</h3>
                        <p class="text-sm text-amber-900 mb-3">Has trabajado <strong class="underline">m√°s</strong> de
                            lo que has facturado.</p>
                        <ul class="text-sm list-disc list-inside text-amber-800/80">
                            <li>Est√°s financiando al cliente.</li>
                            <li>Riesgo de liquidez para pagar n√≥minas.</li>
                            <li><strong>Alerta SCP:</strong> > 15.000‚Ç¨</li>
                        </ul>
                    </div>
                    <div class="p-6 bg-indigo-50 rounded-xl border border-indigo-200">
                        <h3 class="text-indigo-800 font-bold text-lg mb-2">Deferred Revenue - Pasivo</h3>
                        <p class="text-sm text-indigo-900 mb-3">Has facturado <strong class="underline">m√°s</strong> de
                            lo que has trabajado.</p>
                        <ul class="text-sm list-disc list-inside text-indigo-800/80">
                            <li>Es una deuda con el cliente.</li>
                            <li>No te gastes ese dinero.</li>
                            <li>Com√∫n en anticipos (Startups).</li>
                        </ul>
                    </div>
                </div>

                <!-- WIP Chart -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                    <h3 class="font-bold text-slate-700 mb-4 text-center">Visualizaci√≥n de Posici√≥n Contable</h3>
                    <div class="chart-container">
                        <canvas id="wipChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-slate-400 mt-2">Comparativa: Valor Ganado (EV) vs Facturaci√≥n
                        Real</p>
                </div>
            </div>

            <!-- Calculation Methods -->
            <div class="bg-slate-900 rounded-2xl p-8 text-white">
                <h3 class="text-xl font-bold mb-6 border-b border-slate-700 pb-2">M√©todos de Reconocimiento de Ingresos
                    (src/utils/calculations.ts)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <div class="text-teal-400 font-bold text-lg mb-2">Input (Cost-to-Cost)</div>
                        <p class="text-sm text-slate-400 mb-2">Est√°ndar para software/consultor√≠a.</p>
                        <code class="block bg-slate-800 p-2 rounded text-xs font-mono text-teal-200 mb-2">
                            % Avance = Coste Real / Coste Total Est.
                        </code>
                        <div class="text-xs text-red-400">‚ö†Ô∏è Riesgo: Si subestimas costes totales, inflas ingreso
                            artificialmente.</div>
                    </div>
                    <div>
                        <div class="text-amber-400 font-bold text-lg mb-2">Output (Hitos)</div>
                        <p class="text-sm text-slate-400 mb-2">Proyectos "Llave en mano".</p>
                        <code class="block bg-slate-800 p-2 rounded text-xs font-mono text-amber-200 mb-2">
                            Revenue = Valor Hitos Completados
                        </code>
                        <div class="text-xs text-amber-400">‚ö†Ô∏è Riesgo: Curva de ingreso en escalera. Costes continuos,
                            ingresos puntuales.</div>
                    </div>
                    <div>
                        <div class="text-indigo-400 font-bold text-lg mb-2">Linear (Recurrente)</div>
                        <p class="text-sm text-slate-400 mb-2">Mantenimientos.</p>
                        <code class="block bg-slate-800 p-2 rounded text-xs font-mono text-indigo-200 mb-2">
                            Revenue = Presupuesto / Duraci√≥n Meses
                        </code>
                        <div class="text-xs text-indigo-400">Ingreso fijo y predecible.</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: EVM Indicators -->
    <section id="evm" class="py-16 container mx-auto px-4">
        <div class="max-w-4xl mx-auto mb-12 text-center">
            <h2 class="text-3xl font-bold text-slate-900 mb-4">3. El Sem√°foro del Proyecto (EVM)</h2>
            <p class="text-slate-600">
                La gesti√≥n del Valor Ganado (Earned Value Management) responde objetivamente a dos preguntas:
                ¬øEstamos ganando dinero? ¬øVamos a tiempo?
            </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <!-- CPI Chart -->
            <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center">
                <h3 class="text-xl font-bold text-slate-700 mb-1">CPI (Cost Performance Index)</h3>
                <p class="text-xs text-slate-500 mb-4">Eficiencia del Dinero (EV / AC)</p>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="cpiChart"></canvas>
                </div>
                <div class="mt-4 text-center text-sm">
                    <span class="block font-bold text-red-500 mb-1">&lt; 0.85: CR√çTICO (P√©rdidas)</span>
                    <span class="block text-slate-600">> 1.0: Saludable</span>
                </div>
            </div>

            <!-- SPI Chart -->
            <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 flex flex-col items-center">
                <h3 class="text-xl font-bold text-slate-700 mb-1">SPI (Schedule Performance Index)</h3>
                <p class="text-xs text-slate-500 mb-4">Eficiencia del Tiempo (EV / PV)</p>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="spiChart"></canvas>
                </div>
                <div class="mt-4 text-center text-sm">
                    <span class="block font-bold text-amber-500 mb-1">&lt; 0.90: RETRASO</span>
                    <span class="block text-slate-600">> 1.0: Adelanto</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 4: Real World Scenarios -->
    <section id="scenarios" class="py-16 bg-slate-50 border-t border-slate-200">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto mb-12 text-center">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">4. An√°lisis de Escenarios Reales</h2>
                <p class="text-slate-600">
                    Interpretaci√≥n de patrones comunes en SCP System. Diagn√≥stico y acciones correctivas.
                </p>
            </div>

            <!-- Case A: Financial Disaster -->
            <div class="bg-white rounded-2xl shadow-lg border border-red-100 p-8 mb-12">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1">
                        <div class="inline-block px-3 py-1 rounded-full bg-red-100 text-red-700 font-bold text-xs mb-3">
                            CASO A</div>
                        <h3 class="text-2xl font-bold text-slate-800 mb-4">El Desastre Financiero</h3>
                        <ul class="space-y-3 text-sm text-slate-600 mb-6">
                            <li class="flex items-start"><span class="mr-2 text-red-500">‚úñ</span>
                                <strong>S√≠ntoma:</strong> Costes (AC) muy superiores al Valor Ganado (EV).</li>
                            <li class="flex items-start"><span class="mr-2 text-red-500">‚úñ</span>
                                <strong>Diagn√≥stico:</strong> Subestimaci√≥n de complejidad. "Retrabajo" masivo.</li>
                            <li class="flex items-start"><span class="mr-2 text-teal-600">‚ûú</span>
                                <strong>Acci√≥n:</strong> Paralizar. Re-estimar Coste Total. Negociar Change Request.
                            </li>
                        </ul>
                    </div>
                    <div class="lg:col-span-2">
                        <div class="chart-container">
                            <canvas id="scenarioAChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Grid for Case B & C -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Case B: High WIP -->
                <div class="bg-white rounded-2xl shadow-lg border border-amber-100 p-8">
                    <div class="inline-block px-3 py-1 rounded-full bg-amber-100 text-amber-700 font-bold text-xs mb-3">
                        CASO B</div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">El Falso Beneficio (High WIP)</h3>
                    <p class="text-sm text-slate-500 mb-4">Proyecto t√©cnicamente rentable, financieramente peligroso.
                    </p>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="scenarioBChart"></canvas>
                    </div>
                    <div class="mt-4 p-4 bg-amber-50 rounded text-sm text-amber-900">
                        <strong>Acci√≥n:</strong> El PM ha olvidado facturar hitos. Ir a Billing > Facturar WIP
                        inmediatamente.
                    </div>
                </div>

                <!-- Case C: Schedule Risk -->
                <div class="bg-white rounded-2xl shadow-lg border border-indigo-100 p-8">
                    <div
                        class="inline-block px-3 py-1 rounded-full bg-indigo-100 text-indigo-700 font-bold text-xs mb-3">
                        CASO C</div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">Riesgo de Cronograma</h3>
                    <p class="text-sm text-slate-500 mb-4">Fecha fin superada. Hitos pendientes.</p>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="scenarioCChart"></canvas>
                    </div>
                    <div class="mt-4 p-4 bg-indigo-50 rounded text-sm text-indigo-900">
                        <strong>Acci√≥n:</strong> "Crash the project" (Inyectar recursos) solo si la penalizaci√≥n por
                        retraso supera el coste extra.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5: Forecasting & Risk -->
    <section class="py-16 container mx-auto px-4">
        <div class="bg-slate-900 rounded-3xl overflow-hidden shadow-2xl text-white">
            <div class="grid grid-cols-1 lg:grid-cols-2">
                <div class="p-10 flex flex-col justify-center">
                    <h2 class="text-3xl font-bold mb-4">Gesti√≥n de Riesgos & Proyecci√≥n</h2>
                    <p class="text-slate-300 mb-8 leading-relaxed">
                        La versi√≥n 1.2 introduce la <strong>Reserva de Contingencia</strong> (5-10%).
                        El sistema proyecta el cierre (EAC) bas√°ndose en tu eficiencia actual.
                    </p>

                    <div class="space-y-4">
                        <div class="flex items-center gap-4">
                            <div
                                class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center font-bold text-teal-400">
                                1</div>
                            <div>
                                <div class="font-bold">EAC Probable</div>
                                <div class="text-xs text-slate-400">Asume que el CPI actual se mantiene hasta el fin.
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center gap-4">
                            <div
                                class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center font-bold text-indigo-400">
                                2</div>
                            <div>
                                <div class="font-bold">Reserva de Contingencia</div>
                                <div class="text-xs text-slate-400">Colch√≥n para riesgos desconocidos. Si el EAC lo
                                    consume -> Alerta.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-800 p-10">
                    <h3 class="font-bold text-center mb-6">Proyecci√≥n de Cierre (EAC) vs Presupuesto</h3>
                    <div class="chart-container">
                        <canvas id="eacChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white py-8 border-t border-slate-200">
        <div class="container mx-auto px-4 text-center text-slate-400 text-sm">
            <p class="mb-2">&copy; SCP System Training. Material confidencial para uso interno.</p>
            <p class="text-xs font-mono">NO SVG USED. NO MERMAID JS USED. Pure HTML/CSS/Canvas.</p>
        </div>
    </footer>

    <!-- Script Logic -->
    <script>
        // --- Utilities ---

        // 16-char wrapping logic for Chart.js labels
        function splitLabel(str) {
            const maxLen = 16;
            if (str.length <= maxLen) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length <= maxLen) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // Global Chart Defaults
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#64748b';

        const commonPlugins = {
            tooltip: {
                backgroundColor: 'rgba(15, 23, 42, 0.9)',
                padding: 12,
                titleFont: { size: 13, weight: 'bold' },
                bodyFont: { size: 12 },
                callbacks: {
                    title: function (tooltipItems) {
                        const item = tooltipItems[0];
                        let label = item.chart.data.labels[item.dataIndex];
                        if (Array.isArray(label)) {
                            return label.join(' ');
                        } else {
                            return label;
                        }
                    }
                }
            },
            legend: {
                labels: { usePointStyle: true, boxWidth: 8 }
            }
        };

        // --- Charts Implementation ---

        document.addEventListener('DOMContentLoaded', function () {

            // 1. WIP Chart
            const wipCtx = document.getElementById('wipChart').getContext('2d');
            new Chart(wipCtx, {
                type: 'bar',
                data: {
                    labels: [splitLabel('Proyecto A (Riesgo WIP)'), splitLabel('Proyecto B (Start-up)')],
                    datasets: [
                        {
                            label: 'Valor Ganado (Revenue)',
                            data: [45000, 10000],
                            backgroundColor: '#14B8A6', // Teal
                            borderRadius: 6
                        },
                        {
                            label: 'Facturado (Billed)',
                            data: [5000, 30000],
                            backgroundColor: '#0F172A', // Navy
                            borderRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        ...commonPlugins,
                        title: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { color: '#f1f5f9' } },
                        x: { grid: { display: false } }
                    }
                }
            });

            // 2. EVM Gauges (Doughnuts)

            // CPI
            new Chart(document.getElementById('cpiChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Eficiencia', 'P√©rdida'],
                    datasets: [{
                        data: [65, 35], // Represents 0.65 CPI
                        backgroundColor: ['#EF4444', '#f1f5f9'], // Red for bad
                        borderWidth: 0,
                        circumference: 180,
                        rotation: 270,
                        cutout: '75%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: { enabled: false },
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'CPI 0.65',
                            position: 'bottom',
                            color: '#EF4444',
                            font: { size: 24, weight: 'bold' },
                            padding: { bottom: 10 }
                        }
                    }
                }
            });

            // SPI
            new Chart(document.getElementById('spiChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Completado', 'Pendiente'],
                    datasets: [{
                        data: [70, 30], // Represents 0.70 SPI
                        backgroundColor: ['#F59E0B', '#f1f5f9'], // Amber for warning
                        borderWidth: 0,
                        circumference: 180,
                        rotation: 270,
                        cutout: '75%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: { enabled: false },
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'SPI 0.70',
                            position: 'bottom',
                            color: '#F59E0B',
                            font: { size: 24, weight: 'bold' },
                            padding: { bottom: 10 }
                        }
                    }
                }
            });

            // 3. Scenario A (Line Chart - Divergence)
            new Chart(document.getElementById('scenarioAChart'), {
                type: 'line',
                data: {
                    labels: ['M1', 'M2', 'M3', 'M4', 'M5'],
                    datasets: [
                        {
                            label: 'Planned Value (PV)',
                            data: [10000, 20000, 30000, 40000, 50000],
                            borderColor: '#94a3b8',
                            borderDash: [5, 5],
                            pointRadius: 0
                        },
                        {
                            label: 'Earned Value (EV)',
                            data: [8000, 15000, 21000, 25000, 28000], // Low progress
                            borderColor: '#14B8A6',
                            backgroundColor: 'rgba(20, 184, 166, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Actual Cost (AC)',
                            data: [12000, 25000, 45000, 65000, 85000], // Skyrocketing cost
                            borderColor: '#EF4444',
                            borderWidth: 3,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: commonPlugins,
                    interaction: { intersect: false, mode: 'index' },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Euros (‚Ç¨)' } }
                    }
                }
            });

            // 4. Scenario B (Horizontal Bar - High WIP)
            new Chart(document.getElementById('scenarioBChart'), {
                type: 'bar',
                data: {
                    labels: [splitLabel('Estado Financiero Actual')],
                    datasets: [
                        {
                            label: 'Trabajo Realizado (EV)',
                            data: [60000],
                            backgroundColor: '#14B8A6',
                            borderRadius: 4
                        },
                        {
                            label: 'Facturado al Cliente',
                            data: [15000],
                            backgroundColor: '#F59E0B',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: commonPlugins,
                    scales: { x: { beginAtZero: true } }
                }
            });

            // 5. Scenario C (Combo - Schedule Slip)
            new Chart(document.getElementById('scenarioCChart'), {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr (Fin Plan)', 'May (Hoy)'],
                    datasets: [
                        {
                            label: 'Plan Original (PV)',
                            data: [25, 50, 75, 100, null],
                            borderColor: '#6366F1',
                            borderDash: [5, 5],
                            spanGaps: true
                        },
                        {
                            label: 'Avance Real (EV)',
                            data: [20, 35, 45, 60, 70],
                            borderColor: '#F59E0B',
                            borderWidth: 3,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: commonPlugins,
                    scales: {
                        y: { max: 110, title: { display: true, text: '% Completado' } }
                    }
                }
            });

            // 6. EAC Chart (Bar)
            new Chart(document.getElementById('eacChart'), {
                type: 'bar',
                data: {
                    labels: [splitLabel('Presupuesto Original (BAC)'), splitLabel('EAC Probable (Mantener CPI)'), splitLabel('EAC Optimista')],
                    datasets: [{
                        label: 'Proyecci√≥n de Coste Final',
                        data: [100000, 153000, 110000],
                        backgroundColor: [
                            'rgba(148, 163, 184, 0.5)', // Baseline
                            '#EF4444',                  // Danger (Probable)
                            '#14B8A6'                   // Optimistic
                        ],
                        borderColor: [
                            '#94a3b8',
                            '#EF4444',
                            '#14B8A6'
                        ],
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        ...commonPlugins,
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true, ticks: { callback: (v) => v / 1000 + 'k‚Ç¨' } }
                    }
                }
            });
        });
    </script>
</body>

</html>